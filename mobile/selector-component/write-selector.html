<html>
<head>
    <script type="text/javascript" src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <link href="../../bower_components/polymer/polymer.html" rel="import">
    <!-- <link href="../../bower_components/wallcology-selector/test-app.html" rel="import"> -->

    <!-- <link href="../../bower_components/nutella-connector/nutella-connector.html" rel="import"> -->
</head>

<dom-module id="write-selector">
    <style>

    </style>
    <template>

        <!--uncomment this and the two lines in ready to use nutella-->
        <!-- <nutella-connector connected={{connected}} id="nutellaConn" hostname="ltg.evl.uic.edu" appid="wallcology" runid="default"
                           componentid="wallcology_admin"></nutella-connector> -->

        <wallcology-selector class="ws" toggle-selectors="{{toggleSelectors}}" button-selectors="{{buttonSelectors}}"
                             max-selections="4" selected-items="{{selectedItems}}"
                             current-toggle="{{currentToggle}}"></wallcology-selector>
    </template>

    <script>
        // element registration
        Polymer({
            is: 'write-selector',

            // add properties and methods on the element's prototype
            properties: {
                // declare properties for the element's public API
                selectedItems: {
                    type: Array,
                    notify: true,
                    value: []
                },
                currentToggle: {
                    type: Object,
                    notify: true,
                    value: {},
                    observer: 'currentToggleChanged'
                },
                toggleSelectors: {
                    type: Array,
                    notify: true,
                    value: [
                        {
                            'items': [
                                0,
                                1,
                                2,
                                3,
                                4,
                                5,
                                6,
                                7,
                                8,
                                9,
                                10,
                                11,
                                12
                            ],
                            'name': 'Habitat 1',
                            'index': 0,
                        },
                        {
                            'items': [
                                0,
                                1,
                                2,
                                3,
                                4,
                                5,
                                6,
                                7,
                                8,
                                9,
                                10,
                                11,
                                12
                            ],
                            'name': 'Habitat 2',
                            'index': 1,
                        },
                        {
                            'items': [
                                0,
                                1,
                                2,
                                3,
                                4,
                                5,
                                6,
                                7,
                                8,
                                9,
                                10,
                                11,
                                12
                            ],
                            'name': 'Habitat 3',
                            'index': 2,
                        },
                        {
                            'items': [
                                0,
                                1,
                                2,
                                3,
                                4,
                                5,
                                6,
                                7,
                                8,
                                9,
                                10,
                                11,
                                12
                            ],
                            'name': 'Habitat 4',
                            'index': 3,
                        }
                    ]
                },
                buttonSelectors: {
                    type: Array,
                    notify: true,
                    value: [
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_00.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_00_0.svg',
                            'index': 0,
                            'color': '#FFC91B'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_01.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_01_0.svg',
                            'index': 1,
                            'color': '#5A6372'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_02.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_02_0.svg',
                            'index': 2,
                            'color': '#FFDD00'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_03.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_03_0.svg',
                            'index': 3,
                            'color': '#2C4721'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_04.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_04_0.svg',

                            'index': 4,
                            'color': '#502B6E'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_05.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_05_0.svg',
                            'index': 5,
                            'color': '#99cc33'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_06.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_06_0.svg',
                            'index': 6,
                            'color': '#8975B5'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_07.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_07_0.svg',
                            'index': 7,
                            'color': '#FAAA19'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_08.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_08_0.svg',
                            'index': 8,
                            'color': '#899C7C'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_09.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_09_0.svg',
                            'index': 9,
                            'color': '#4AB6C8'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/species_10.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/species_10_0.svg',
                            'index': 10,
                            'color': '#68734F'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/env_temp.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/env_temp_0.svg',
                            'index': 11,
                            'color': '#FF5722'
                        },
                        {
                            'highlightUrl': 'https://ltg.cs.uic.edu/WC/icons/env_pipe.svg',
                            'activeUrl': 'https://ltg.cs.uic.edu/WC/icons/env_pipe_0.svg',
                            'index': 12,
                            'color': '#795548'
                        }
                    ]
                },
                connected: {
                    type: Boolean,
                    notify: true,
                    value: false,
                    observer: 'connectedChanged'
                },
            },
            observers: [
                'selectedItemsChanged(selectedItems.*)',
                'toggleSelectorsChanged(toggleSelectors.*)',
                'buttonSelectorsChanged(buttonSelectors.*)'
            ],
            selectedItemsChanged: function (changeRecord) {
                if (changeRecord.path == 'selectedItems.splices') {
                    // a user was added or removed
                } else {
                    // an individual user or its sub-properties changed
                    // check "changeRecord.path" to determine what changed
                }
            },
            toggleSelectorsChanged: function (changeRecord) {

            },
            buttonSelectorsChanged: function (changeRecord) {

            },
            currentToggleChanged: function (newValue, oldValue) {
                console.log('toggle changed write-selector', newValue, oldValue);
            },
            connectedChanged: function (newValue, oldValue) {
                var me = this;
                console.log('connected changed', newValue, oldValue);
                if (newValue === true) {
                    this.$.nutellaConn.nutella.net.request('master_configuration', {}, function (r) {
                        if (r !== undefined) {
                            me.buttonSelectors = r.habitatItems;

                            var start = [{
                                'items': [],
                                'name': 'Habitat ?',
                                'index': -1
                            }];
                            me.toggleSelectors = start.concat(r.habitats);

                            var all = {
                                'items': [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6,
                                    7,
                                    8,
                                    9,
                                    10
                                ],
                                'name': 'All Habitats',
                                'index': 4
                            };
                            me.toggleSelectors.push(all);

                            console.log('MASTER CONFIG FETCHED');
                        }
                    });
                }
            },
            ready: function () {
                this.selectedItems = [];
                // this.buttonSelectors = [];
                // this.toggleSelectors = [];

                var start = [{
                    'items': [],
                    'name': 'Habitat ?',
                    'index': -1
                }];
                this.toggleSelectors = start.concat(this.toggleSelectors);

                var all = {
                    'items': [
                        0,
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10
                    ],
                    'name': 'All Habitats',
                    'index': 4
                };
                this.toggleSelectors.push(all);
            }
        });
    </script>
</dom-module>
